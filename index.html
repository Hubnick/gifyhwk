<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Quoth the Giphy</title>
</head>
<style type="text/css">
    form,
    .item,
    input {
        margin: 10px;
    }

    .item {
        float: left;
    }
</style>

<body>

    <button data-person="Arnold Schwarzenegger">
        I'll be back</button>

    <button data-person="Michael J Fox">
        My happiness grows in direct proportionto my acceptance, and in inverse proportion to my expectations.</button>

    <button data-person="Lucille Ball">
        Love yourself first and everything else falls into line.</button>

    <button data-person="Taylor Swift">
        If you're horrible to me, I'm going to write a song about it, and you won't like it. That's how I operate.</button>

    <button data-person="Samuel Jackson">
        Far better is it to dare mighty things, to win glorious triumphs, even though checkered by failure... than to rank with those
        poor spirits who neither enjoy nor suffer much, because they live in a gray twilight that knows not victory nor defeat.</button>

    <div id="buttons-view"></div>

    <form id="movie-form">
        <label for="movie-input">Add a Movie, Yo!</label>
        <input type="text" id="movie-input">
        <br>

        <!-- Button triggers new movie to be added -->
        <input id="add-movie" type="submit" value="Add a Movie, Yo!">
    </form>


    <div id="gifs-appear-here">
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">

        $(document).on("click", "button", function () {
            var person = $(this).attr("data-person");

            var queryURL = "https://api.giphy.com/v1/gifs/search?q=" +
                person + "&api_key=1E62eHrzN7CrREzGzrRK2ztS2D92OUPC&limit=10";

            $.ajax({
                url: queryURL,
                method: "GET"
            })
                .then(function (response) {
                    var results = response.data;
                    console.log(results)

                    for (var i = 0; i < results.length; i++) {

                        if (results[i].rating !== "r" && results[i].rating !== "pg-13") {
                            var gifDiv = $("<div class='item'>");

                            var rating = results[i].rating;

                            var p = $("<p>").text("Rating: " + rating);

                            var personImage = $("<img>");

                            personImage.attr("src", results[i].images.fixed_height_still.url);
                            personImage.attr("data-still", results[i].images.fixed_height_still.url);
                            personImage.attr("data-animate", results[i].images.fixed_height.url);
                            personImage.attr("data-state", "still");
                            personImage.addClass("gif");
                            console.log(personImage);


                            gifDiv.append(p);
                            gifDiv.append(personImage);


                            $("#gifs-appear-here").prepend(gifDiv);
                        }
                    }
                });
        });


        $(document).on("click", ".gif", function () {

            var state = $(this).attr("data-state");

            if (state === "still") {
                $(this).attr("src", $(this).attr("data-animate"));
                $(this).attr("data-state", "animate");
            } else {
                $(this).attr("src", $(this).attr("data-still"));
                $(this).attr("data-state", "still");
            }
        });

        var movies = [];

        function renderButtons() {

            $("#buttons-view").empty();

            for (var i = 0; i < movies.length; i++) {

                var a = $("<button>");

                a.addClass("movie");
                a.attr("data-person", movies[i]);
                a.text(movies[i]);

                $("#buttons-view").append(a);
            }
        }


        $("#add-movie").on("click", function (event) {

            event.preventDefault();

            var movie = $("#movie-input").val().trim();

            movies.push(movie);

            renderButtons();
        });


        renderButtons();



    </script>
</body>

</html>